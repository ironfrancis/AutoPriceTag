# 版本更新说明

## 2025-10-27 版本更新

### 🎉 新增功能

#### 1. **云端存储集成（Supabase）**
- 支持设计稿云端保存与同步
- 持久化存储，不再局限于本地
- 多设备、多用户支持
- 完善的权限控制（RLS）

**使用步骤：**
1. 点击"云端同步"按钮
2. 注册账号（填写基本信息）
3. 登录后点击"保存标签"即可云端保存

#### 2. **优化注册流程**
- **新增字段**：
  - 公司/店铺名称
  - 所属行业（8个选项，可视化选择）
  - 职位身份（5个选项，可视化选择）
  - 团队规模
- **交互优化**：
  - 卡片式选择器，易于操作
  - 选中状态高亮显示
  - 实时表单验证
  - 友好的错误提示

#### 3. **智能尺寸适配**
- 自动响应标签尺寸变化
- 使用相对位置（百分比）存储
- 支持跨尺寸布局复用
- 避免元素超出边界

**工作机制：**
- 所有元素位置按百分比（0-100）存储
- 尺寸变化时自动重新计算像素位置
- 保持元素在可见区域内

### 🔧 功能改进

#### 1. **保存/加载优化**
- 每次保存创建新记录
- 支持设计历史管理
- 记录创建时间、更新时间
- 保存列表支持删除操作

#### 2. **用户界面优化**
- 云端同步按钮改为状态指示器
- 独立的"保存标签"按钮
- Toast 提示信息优化
- 统一的属性编辑器组件

### 🐛 问题修复

1. **修复字体配置同步问题**
   - 动态元素（卖点、规格、自定义字段）现在正确显示字体编辑控件
   - 自动为未配置元素生成默认字体设置

2. **修复尺寸变化后的元素位置**
   - 确保所有元素在尺寸变化后仍可见
   - 保持相对位置关系

3. **优化数据持久化**
   - 从 localStorage 迁移到 Supabase
   - 更可靠的数据存储
   - 支持数据备份与恢复

### 📊 技术改进

1. **数据架构优化**
   - 引入 `ElementStyleConfig` 支持扩展样式
   - 优化 `LayoutElement` 结构
   - 添加元素类型和可见性标记

2. **代码质量提升**
   - 统一元素属性编辑器（`ElementPropertyEditor`）
   - 完善注释说明
   - 优化组件性能

3. **安全性增强**
   - Row Level Security (RLS) 策略
   - 用户数据隔离
   - 权限验证机制

### 📝 数据库迁移

新增表结构：
- `projects` 表：存储用户设计稿
- `user_profiles` 表：存储用户扩展信息（可选）

配置位置：`supabase/migrations/`

### 🚀 升级建议

1. **环境配置**
   - 配置 `NEXT_PUBLIC_SUPABASE_URL`
   - 配置 `NEXT_PUBLIC_SUPABASE_ANON_KEY`

2. **数据库初始化**
   - 运行 Supabase 迁移脚本
   - 配置 RLS 策略

3. **数据迁移**
   - 旧版 localStorage 数据需要手动导入
   - 使用"导入设计"功能加载旧数据

### 📖 使用文档

详细的配置说明请参考：
- `supabase/README.md` - Supabase 配置指南
- `docs/DATA_HANDLING_PRINCIPLES.md` - 数据处理原理
- `docs/UNIFIED_DATA_TABLE.md` - 数据表结构说明

### 👥 致谢

感谢所有为本次更新贡献的用户和开发者。

---

**注意：** 本次更新需要配置 Supabase 环境变量才能使用云端存储功能。本地存储功能仍然可用。

